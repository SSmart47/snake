var main_content=document.getElementById("id_my_1"),cscore=document.getElementById("id_score"),c_hcell_num="41",c_vcell_num="41",c_cell_width="15",c_cell_height="15",CurScore=0,fruitX=-1,fruitY=-1,fruit="red",c_bgcolor="rgba(255,255,255,0.1)",direction="none",ghostMode="1",gameOver=!1,snake_head="aqua",snake_body="blue",snake_maxlen=38,border="rgba(255,255,255,0.2)",mtrx=Arr(parseInt(c_hcell_num),Arr(parseInt(c_vcell_num),0)),snakeX=[],snakeY=[],c_content_width=parseInt(c_cell_width)*parseInt(c_hcell_num)+"px",c_content_height=parseInt(c_cell_height)*parseInt(c_vcell_num)+"px";main_content.innerHTML+='<center><svg id="id_drw_content_1"></svg></center>';var content=document.getElementById("id_drw_content_1");function Arr(e,n){e=parseInt(e);for(var t=[],r=0;r<e;r++)t.push(n);return t}function Col(e,n,t){document.getElementById("cell_"+e+"_"+n).setAttribute("fill",t)}function Exist(e,n){for(var t=0;t<e.length;t++)if(e[t]==n)return!0;return!1}function NewFruit(){for(;;){for(var e=parseInt(100*Math.random())%parseInt(c_vcell_num),n=parseInt(100*Math.random())%parseInt(c_hcell_num);0==e||e==parseInt(c_vcell_num)-1;)e=parseInt(100*Math.random())%parseInt(c_vcell_num);for(;0==n||n==parseInt(c_hcell_num)-1;)n=parseInt(100*Math.random())%parseInt(c_hcell_num);if(!Exist(snakeX,e)&&!Exist(snakeY,n))break}fruitY=fruitX=0,Col(fruitX+=e,fruitY+=n,fruit)}function Rectangle(e,n,t,r,a){return'<rect x="'+e+'" y="'+n+'" width="'+t+'" height="'+r+'" fill="'+a+'" />'}function RectangleID(e,n,t,r,a,c){return'<rect id="'+c+'" x="'+e+'" y="'+n+'" width="'+t+'" height="'+r+'" fill="'+a+'" />'}function GenerateRectangles(){for(var e="",n=0;n<c_hcell_num;n++)for(var t=0;t<c_vcell_num;t++){var r="cell_"+n+"_"+t;e+=RectangleID(t*parseInt(c_cell_height),n*parseInt(c_cell_width),c_cell_width,c_cell_height,c_bgcolor,r)}content.innerHTML=e}function SetBorder(){for(var e=parseInt(c_hcell_num),n=parseInt(c_vcell_num),t=0;t<n;t++)Col(t,"0",border),Col(t,e-1,border);for(var r=0;r<e;r++)Col("0",r,border),Col(n-1,r,border)}function SetNewCoords(e,n){var t=0,r=0;Col(t+=snakeX[snakeX.length-1],r+=snakeY[snakeY.length-1],c_bgcolor);for(var a=snakeX.length-1;0<a;a--)snakeX[a]=0,snakeX[a]+=snakeX[a-1],snakeY[a]=0,snakeY[a]+=snakeY[a-1];1<snakeX.length&&Col(snakeX[0],snakeY[0],snake_body),snakeX[0]=0,snakeY[0]=0,snakeX[0]+=e,snakeY[0]+=n,Col(e,n,snake_head),e==fruitX&&n==fruitY&&(snakeX.length<snake_maxlen&&(snakeX.push(t),snakeY.push(r),Col(t,r,snake_body)),CurScore++,cscore.innerHTML="Score: "+CurScore,NewFruit());for(a=1;a<snakeX.length;a++)if(snakeX[0]==snakeX[a]&&snakeY[0]==snakeY[a]){GameOver();break}}function GameOver(){gameOver=!0,document.getElementById("id_g_o").innerHTML='<br><font class="css-game-over">Game Over!</font>'}function Mirrored(e){return"left"==e?"right":"right"==e?"left":"up"==e?"down":"down"==e?"up":"none"}content.style="width:"+c_content_width+";height:"+c_content_height+";",GenerateRectangles(),NewFruit(),SetBorder(),snakeX.push(parseInt(parseInt(c_hcell_num)/2)),snakeY.push(parseInt(parseInt(c_vcell_num)/2)),mtrx[snakeX[0]][snakeY[0]]=1,Col(snakeX[0],snakeY[0],snake_head),setInterval(function(){var e,n,t;gameOver||(e="",e+=direction,n=0,n+=snakeX[t=0],t+=snakeY[0],"left"==e?(0==--t&&("0"==ghostMode?GameOver():t=parseInt(c_hcell_num)-2),SetNewCoords(n,t)):"right"==e?(++t==parseInt(c_hcell_num)-1&&("0"==ghostMode?GameOver():t=1),SetNewCoords(n,t)):"up"==e?(0==--n&&("0"==ghostMode?GameOver():n=parseInt(c_vcell_num)-2),SetNewCoords(n,t)):"down"==e&&(++n==parseInt(c_vcell_num)-1&&("0"==ghostMode?GameOver():n=1),SetNewCoords(n,t)))},50),window.addEventListener("keydown",e=>{var n="",t="none";if("ArrowLeft"==(n+=e.code)||"KeyA"==n)t="left";else if("ArrowRight"==n||"KeyD"==n)t="right";else if("ArrowUp"==n||"KeyW"==n)t="up";else{if("ArrowDown"!=n&&"KeyS"!=n)return;t="down"}t!=Mirrored(direction)&&(direction="",direction+=t)});
